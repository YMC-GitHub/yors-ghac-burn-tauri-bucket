(()=>{"use strict";var e={136:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.builtinBurnBucketOption=void 0;t.usage=usage;t.conf=conf;t.main=main;function usage(){let e="";e=`\nusage:\n<ns> [option]\n\ndemo:\nburn-bucket --path target --bucket-loc bucket/usage.json --browser-download-url-prefix yours/url\n\nmethod:\ndelete,put,get\n\noption:\n-v,--version boolean                      info version (default:false)\n-h,--help boolean                         info help (default:false)\n                                          \n--path string                             set the tauri app location (default:target)\n--bucket-loc string                       set the output location (default:updater/usage.json) \n--pkg-org string                          set name prefix (default:) \n--browser-download-url-prefix string      set url prefix (default:)\n`;return e}t.builtinBurnBucketOption={v:false,version:false,h:false,help:false,path:"target",bucketLoc:"updater/{name}.json",pkgOrg:"",browserDownloadUrlPrefix:""};function conf(e,t){return Object.assign(Object.assign({},t?t:{}),e?e:{})}function main(e){const n=conf(e,t.builtinBurnBucketOption);return n}},972:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(r.next(e))}catch(e){o(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.runNano=runNano;t.runArgv=runArgv;const o=n(574);const i=n(136);const s=n(637);function runNano(e){return r(this,void 0,void 0,(function*(){let t=e.flags;const n=(0,o.iniStoreTree)();const i=(0,o.readAssetsFromLocation)(t.path,t.browserDownloadUrlPrefix,t.pkgOrg);const s=i.assets.map((e=>r(this,void 0,void 0,(function*(){let t=(0,o.getStore)(n,e.store_file);if(!t){t=(0,o.addStore)(n,e.store_file,(0,o.iniStore)(e.pkgversion,e.note))}yield(0,o.setAsset)(e,/.msi.zip/,["win64","windows-x86_64"],t);yield(0,o.setAsset)(e,/.app.tar.gz/,["darwin","darwin-x86_64","darwin-aarch64"],t);yield(0,o.setAsset)(e,/.AppImage.tar.gz/,["linux","linux-x86_64"],t)}))));yield Promise.all(s);Object.keys(n).map((e=>{const r=t.bucketLoc.replace(/{name}/gi,e);(0,o.wirteInstallJson)(r,(0,o.getStore)(n,e))}))}))}function runArgv(e){return r(this,arguments,void 0,(function*(e,t={}){let n=[undefined,""];let r=(0,s.getNanoFromArgvAndDefaultFlag)(e,i.builtinBurnBucketOption,n);let o=r.flags;if(o.help){console.log(t.usage);process===null||process===void 0?void 0:process.exit(0)}if(o.version){console.log(t.version||"0.1.0");process===null||process===void 0?void 0:process.exit(0)}return runNano(r)}))}},637:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.nanoFlagShimValueExtract=nanoFlagShimValueExtract;t.nanoFlagShimKeysPassed=nanoFlagShimKeysPassed;t.humanize=humanize;t.slugify=slugify;t.camelize=camelize;t.underscoped=underscoped;t.classify=classify;t.swapCase=swapCase;t.getFlagFromProcessEnv=getFlagFromProcessEnv;t.StrvParse=StrvParse;t.nanoargs=nanoargs;t.getNanoFromStra=getNanoFromStra;t.getStraFromStro=getStraFromStro;t.nanoArgvStroToStra=nanoArgvStroToStra;t.TrimQuotation=TrimQuotation;t.EndsWithQuotation=EndsWithQuotation;t.StartWithQuotation=StartWithQuotation;t.WrapedQuotation=WrapedQuotation;t.WrapQuotation=WrapQuotation;t.FindQuotationText=FindQuotationText;t.FindNoQuotationText=FindNoQuotationText;t.TrimQuotationText=TrimQuotationText;t.NomalizeQuotationText=NomalizeQuotationText;t.nanoFlagKeysCamelize=nanoFlagKeysCamelize;t.nanoFlagShimValueExclude=nanoFlagShimValueExclude;t.putFlag=putFlag;t.getNanoFromArgvAndDefaultFlag=getNanoFromArgvAndDefaultFlag;function nanoFlagShimValueExtract(e,t=[undefined]){const n={};Object.keys(e).forEach((r=>{let o=e[r];if(t.includes(o)){n[r]=o}}));return n}function nanoFlagShimKeysPassed(e,t){let n={};for(let r=0;r<e.length;r++){const o=e[r];n[o]=t[o]}return n}function humanize(e){return e.replace(/(?:^\w|[A-Z_-]|\b\w)/g,((e,t)=>{let n="";n=e.replace(/[-_]+/g," ");n=t!==0?n.replace(/[A-Z]/," $&"):n;return t===0?n.toUpperCase():n.toLowerCase()})).replace(/\s+/g," ")}function slugify(e){return humanize(e).replace(/(?:^\w|[A-Z]|\b\w)/g,(e=>e.toLowerCase())).replace(/\s+/g,"-")}function camelize(e){return humanize(e).replace(/(?:^\w|[A-Z]|\b\w)/g,((e,t)=>t===0?e.toLowerCase():e.toUpperCase())).replace(/\s+/g,"")}function underscoped(e){return humanize(e).replace(/(?:^\w|[A-Z]|\b\w)/g,(e=>e.toLowerCase())).replace(/\s+/g,"_")}function classify(e){return humanize(e).replace(/(?:^\w|[A-Z]|\b\w)/g,(e=>e.toUpperCase())).replace(/\s+/g,"")}function swapCase(e){return e.replace(/(?:^\w|[A-Z-a-z]|\b\w)/g,(e=>{if(/[A-Z]/.test(e)){return e.toLowerCase()}return e.toUpperCase()}))}function getFlagFromProcessEnv(e){let t=e.map((e=>underscoped(e).toUpperCase()));if(process===null||process===void 0?void 0:process.env){return nanoFlagShimKeysPassed(t,process.env)}return{}}function StrvParse(e,t=""){if(t==="string"){return String(e)}if([true].includes(e)||strIsOneOfThem(e,["true"])){return true}if([false].includes(e)||strIsOneOfThem(e,["false"])){return false}if(Number(e)){return Number(e)}if([null].includes(e)||strIsOneOfThem(e,["null"])){return null}if([undefined].includes(e)||strIsOneOfThem(e,["undefined"])){return undefined}return String(e)}function strIsOneOfThem(e,t=[]){return t.some((t=>t.toLowerCase()==e.toLowerCase()))}function nanoargs(e,t={nanoFlagParse:nanoFlagParse}){const n=nanoArgvStraSimple(e);let r=[];let o=[];({tail:r,head:o}=nanoArgsStraDecode(n));const{argvs:i,argsMap:s}=nanoArgsHeadDecode(o);const a=nanoArgsHeadKvpDecode(s);return{flags:t.nanoFlagParse(a),argv:i,extras:r}}function nanoArgvStraSimple(e){return Array.isArray(e)?e:e.split(/ +/)}function nanoValIsOneOfThem(e,t,n=false){return t.some((t=>{if(n&&typeof t==="string"&&typeof e==="string"){return t.toLowerCase()==e.toLowerCase()}return t==e}))}function nanoArgsStraDecode(e){let t=e;let n=[];const r=e.indexOf("--");if(e.includes("--")){n=e.slice(r+1);t=e.slice(0,r)}return{tail:n,head:t}}function nanoArgsHeadDecode(e){const t=[];const n=[];for(let r=0;r<e.length;r++){const o=e[r-1];const i=e[r];const s=e[r+1];const a=s&&!/^--.+/.test(s)&&!/^-.+/.test(s);const pushWithNext=e=>{n.push([e,a?s:"true"])};if(/^--.+=/.test(i)||/^-.=/.test(i)){const[e,t]=i.split("=");n.push([e,t])}else if(/^-[^-].*/.test(i)){let e=i;if(e.includes("=")){const t=e.indexOf("=");n.push([e.slice(t-1,t),e.slice(t+1,t+2)]);e=e.slice(0,t-1)+e.slice(t+2)}const t=e.slice(1).split("").slice(0,-1);for(const e of t){n.push([e,"true"])}const r=e[e.length-1];pushWithNext(r)}else if(/^--.+/.test(i)||/^-.+/.test(i)){pushWithNext(i)}else{let e=n.find((e=>e[0]===o));if(!e&&/^-./.test(o)){const t=o[o.length-1];e=n.find((e=>e[0]===t))}if(!e){t.push(i)}}}return{argvs:t,argsMap:n}}function nanoArgsHeadKvpDecode(e){const t={};for(const n of e){let e=n[0].replace(/^-{1,2}/g,"");let r=n[1];if(e.startsWith("no-")&&nanoValIsOneOfThem(r,[undefined,true,"","true"])){e=e.slice(3);r="false"}t[e]=r}return t}function nanoFlagParse(e,t={nanoStrvParse:StrvParse}){const n={};Object.keys(e).forEach((r=>n[r]=t.nanoStrvParse(e[r])));return n}function getNanoFromStra(e){return nanoargs(e)}function getStraFromStro(e){return nanoArgvStroToStra(e)}function nanoArgvStroToStra(e){const t=[];const n=e.trim();const r=n.split(/ /);let o=true;let i=[];for(let e=0;e<r.length;e++){const n=r[e];if(o){o=StartWithQuotation(n)?false:true}if(!o){if(EndsWithQuotation(n)){o=true;t.push(TrimQuotation([...i,n].join(" ")));i=[]}else{i.push(n)}}else{t.push(TrimQuotation(n))}}return t}function TrimQuotation(e){return e.replace(/(^("|'))|(("|')$)/g,"")}function EndsWithQuotation(e){return/("|')$/.test(e)}function StartWithQuotation(e){return/^("|')/.test(e)}function WrapedQuotation(e){return/(^"[^"]*"$)|(^'[^']*'$)/.test(e)}function WrapQuotation(e,t='"'){return[t,TrimQuotation(e),t].join("")}function FindQuotationText(e,t=false){const n=/("[^"]*")|('[^']*')/g;const r=e.match(n);return r?t?r.map((e=>TrimQuotation(e))):r:[]}function FindNoQuotationText(e){const t=e.trim().replace(/("[^"]*")|('[^']*')/g,"");return t.split(/ +/).filter((e=>e))}function TrimQuotationText(e){let t=e;const n=FindQuotationText(t,false);for(let e=0;e<n.length;e++){const r=n[e];t=t.replace(r,TrimQuotation(r))}return t}function NomalizeQuotationText(e,t="double-quotation"){let n=e;const r=FindQuotationText(n,false);for(let e=0;e<r.length;e++){const o=r[e];n=n.replace(o,WrapQuotation(o,t==="double-quotation"?`"`:`'`))}return n}function nanoFlagKeysCamelize(e={},t={}){const n=Object.assign({slim:true,noAutoCamelize:false},t);if(n.noAutoCamelize)return e;Object.keys(e).forEach((t=>{const r=camelize(t);if(r!==t){e[r]=e[t];if(n.slim){delete e[t]}}}));return e}function nanoFlagShimValueExclude(e,t=[undefined]){const n={};Object.keys(e).forEach((r=>{let o=e[r];if(!t.includes(o)){n[r]=o}}));return n}function putFlag(...e){let t={};for(let n=0;n<e.length;n++){const r=e[n];t=Object.assign(Object.assign({},t),r)}return t}function getNanoFromArgvAndDefaultFlag(e,t,n=[undefined,""]){let r=Object.keys(t);let o=Object.assign({},t);let i=nanoFlagKeysCamelize(getFlagFromProcessEnv(r));let s=getNanoFromStra(e);let a=nanoFlagKeysCamelize(s.flags);let u=putFlag(o,nanoFlagShimValueExclude(i,n),nanoFlagShimValueExclude(a,n));s.flags=u;return s}},420:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(r.next(e))}catch(e){o(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const i=n(136);const s=n(972);const a=o(n(598));function run(){return r(this,void 0,void 0,(function*(){return(0,s.runArgv)(process.argv.slice(2),{usage:(0,i.usage)(),version:a.default.version})}))}run().catch(console.error)},574:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(r.next(e))}catch(e){o(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.getStore=getStore;t.iniStore=iniStore;t.addStore=addStore;t.iniStoreTree=iniStoreTree;t.readAssetsFromLocation=readAssetsFromLocation;t.loc2asset=loc2asset;t.setAsset=setAsset;t.wirteInstallJson=wirteInstallJson;t.getSignatureFromUrl=getSignatureFromUrl;t.saveJsonFileSync=saveJsonFileSync;t.saveTextFileSync=saveTextFileSync;t.readTextFileSync=readTextFileSync;t.makeDirs=makeDirs;t.nanoPathJoin=nanoPathJoin;t.readFileList=readFileList;const o=n(147);const i=n(17);function getStore(e,t){const n=e[t];return n}function iniStore(e="",t=""){return{version:e,notes:t,pub_date:(new Date).toISOString(),platforms:{win64:{signature:"",url:""},linux:{signature:"",url:""},darwin:{signature:"",url:""},"darwin-aarch64":{signature:"",url:""},"darwin-x86_64":{signature:"",url:""},"linux-x86_64":{signature:"",url:""},"windows-x86_64":{signature:"",url:""}}}}function addStore(e,t,n){if(!e[t]){e[t]=n}return e[t]}function iniStoreTree(){return{}}function readAssetsFromLocation(e=`target`,t="",n=""){const r={assets:[]};const o=readFileList(e).filter((e=>/.sig$/.test(e)));r.assets=o.map((e=>loc2asset(e,t,n)));return r}function loc2asset(e,t="",n=""){const r=e.split("/");const o=r[r.length-1];const i=o.replace(/.sig$/,"");const[s,a]=i.split("_");const u=t.replace(/{version}/gi,a).replace(/{name}/gi,s);const l=readTextFileSync(e,"");return{name:o,file:e,signature:l,browser_download_url:[u,i].filter((e=>e)).join("/"),store_file:[n,s].filter((e=>e)).join("."),pkgname:s,pkgversion:a}}function setAsset(e,t,n,o){return r(this,void 0,void 0,(function*(){let r="";if(/.sig$/.test(e.name)){if(e.signature){r=e.signature}else{r=yield getSignatureFromUrl(e.browser_download_url)}}n.forEach((n=>{if(t.test(e.name)){if(r){o.platforms[n].signature=r}o.platforms[n].url=e.browser_download_url}}))}))}function wirteInstallJson(e,t){saveJsonFileSync(e,t);console.log(`Generate ${e}`)}function getSignatureFromUrl(e){return r(this,void 0,void 0,(function*(){try{const t=yield fetch(e,{method:"GET",headers:{"Content-Type":"application/octet-stream"}});return t.text()}catch(e){return""}}))}function saveJsonFileSync(e,t){const n=typeof t!=="string"?JSON.stringify(t,null,2):t;saveTextFileSync(e,n)}function saveTextFileSync(e,t=""){makeDirs(e);(0,o.writeFileSync)(e,t)}function readTextFileSync(e,t=""){let n=t;if(!(0,o.existsSync)(e))return n;try{n=(0,o.readFileSync)(e).toString()}catch(e){n=t}return n}function makeDirs(e){const t=(0,i.dirname)((0,i.resolve)(e));if(!(0,o.existsSync)(t))(0,o.mkdirSync)(t,{recursive:true})}function nanoPathJoin(...e){return e.filter((e=>e.trim())).join("/").replace(/\\/,"/")}function readFileList(e){const t=(0,o.readdirSync)(e);const n=[];for(let r=0;r<t.length;r++){const i=t[r];const s=nanoPathJoin(e,i);if((0,o.statSync)(s).isDirectory()){let e=readFileList(s);e=e.filter((e=>(0,o.statSync)(e).isFile()));n.push(...e)}else{n.push(s)}}return n}},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")},598:e=>{e.exports=JSON.parse('{"name":"yors-ghac-burn-tauri-bucket","version":"0.1.1","description":"a github action to burn tauri bucket mono repo","keywords":["artist","yors-ghac-burn-tauri-bucket","mono"],"author":"yemiancheng <ymc.github@gmail.com>","license":"MIT","private":false,"main":"dist/index.js","scripts":{"build":"tsc","release":"ncc build src/burn-bucket.ts && git add -f dist/","release-ncli":"ncc build src/burn-bucket-ncli.ts -o ncli --minify","check-all":"concurrently \\"npm:format-check\\" \\"npm:lint\\" \\"npm:build\\"","format":"prettier --write **/*.ts","format-check":"prettier --check **/*.ts","lint":"eslint **/*.ts","lint-fix":"eslint **/*.ts --fix"},"repository":{"type":"git","url":"git+https://github.com/ymc-github/yors-ghac-burn-tauri-bucket.git"},"bugs":{"url":"git+https://github.com/ymc-github/yors-ghac-burn-tauri-bucket/issues"},"homepage":"https://github.com/ymc-github/yors-ghac-burn-tauri-bucket/blob/main/#readme","devDependencies":{"@types/node":"^12.12.6","@typescript-eslint/eslint-plugin":"^6.14.0","@vercel/ncc":"^0.33.4","concurrently":"^5.2.0","eslint":"^8.55.0","eslint-plugin-github":"^4.10.1","eslint-plugin-prettier":"^5.0.1","prettier":"^3.1.1","typescript":"^5.3.3"},"dependencies":{"@actions/artifact":"^2.1.6","@actions/core":"^1.10.1","@actions/github":"^5.1.1","minimatch":"^9.0.3"},"bin":{"burn-bucket":"ncli/index.js"}}')}};var t={};function __nccwpck_require__(n){var r=t[n];if(r!==undefined){return r.exports}var o=t[n]={exports:{}};var i=true;try{e[n].call(o.exports,o,o.exports,__nccwpck_require__);i=false}finally{if(i)delete t[n]}return o.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var n=__nccwpck_require__(420);module.exports=n})();